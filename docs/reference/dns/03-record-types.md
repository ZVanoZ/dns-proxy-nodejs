# Типы DNS записей

DNS записи хранят различную информацию о доменах. В этом разделе мы рассмотрим основные типы записей.

## Общие сведения

Каждая DNS запись имеет:
- **Имя (Name)** — доменное имя, к которому относится запись
- **Тип (Type)** — тип записи (A, AAAA, CNAME и т.д.)
- **TTL (Time To Live)** — время жизни записи в секундах
- **Данные (Data)** — конкретная информация в зависимости от типа

## Основные типы записей

### A (Address) — IPv4 адрес

Связывает доменное имя с IPv4 адресом.

**Пример:**
```
example.com.    IN    A    93.184.216.34
```

**Использование:**
- Указывает IP-адрес веб-сервера
- Самая распространенная запись для веб-сайтов

**Формат данных:**
- 4 байта IPv4 адреса

**RFC:** RFC 1035

---

### AAAA (IPv6 Address) — IPv6 адрес

Связывает доменное имя с IPv6 адресом.

**Пример:**
```
example.com.    IN    AAAA    2001:db8::1
```

**Использование:**
- Указывает IPv6 адрес сервера
- Используется для поддержки IPv6

**Формат данных:**
- 16 байт IPv6 адреса

**RFC:** RFC 3596

---

### CNAME (Canonical Name) — Псевдоним

Создает алиас (псевдоним) для доменного имени, указывая на другое доменное имя.

**Пример:**
```
www.example.com.    IN    CNAME    example.com.
example.com.        IN    A        93.184.216.34
```

**Использование:**
- Создание псевдонимов (например, `www.example.com` → `example.com`)
- Упрощение управления несколькими поддоменами

**Важно:**
- CNAME не может сосуществовать с другими записями для того же имени
- CNAME всегда указывает на другое доменное имя, а не на IP-адрес

**RFC:** RFC 1035

---

### MX (Mail Exchange) — Почтовый сервер

Указывает почтовый сервер для домена.

**Пример:**
```
example.com.    IN    MX    10    mail.example.com.
mail.example.com.    IN    A    192.0.2.1
```

**Параметры:**
- **Приоритет (Priority)** — число от 0 до 65535 (меньше = выше приоритет)
- **Имя сервера** — доменное имя почтового сервера

**Использование:**
- Определяет, куда отправлять электронную почту для домена
- Можно указать несколько серверов с разными приоритетами

**RFC:** RFC 1035

---

### NS (Name Server) — DNS сервер

Указывает авторитативный DNS сервер для домена или поддомена.

**Пример:**
```
example.com.    IN    NS    ns1.example.com.
example.com.    IN    NS    ns2.example.com.
```

**Использование:**
- Определяет, какие серверы отвечают за DNS зону
- Используется для делегирования поддоменов

**RFC:** RFC 1035

---

### PTR (Pointer) — Обратная запись

Используется для обратного DNS-запроса (reverse DNS lookup) — преобразование IP-адреса в доменное имя.

**Пример:**
```
34.216.184.93.in-addr.arpa.    IN    PTR    example.com.
```

**Использование:**
- Обратный поиск IP → домен
- Проверка подлинности серверов
- Логирование и отладка

**Важно:**
- Используется специальный формат: IP-адрес записывается в обратном порядке с суффиксом `.in-addr.arpa` (для IPv4) или `.ip6.arpa` (для IPv6)

**RFC:** RFC 1035

---

### TXT (Text) — Текстовая запись

Хранит произвольный текст.

**Пример:**
```
example.com.    IN    TXT    "v=spf1 mx ~all"
example.com.    IN    TXT    "google-site-verification=abc123"
```

**Использование:**
- SPF записи для защиты от спама
- DKIM ключи для подписи почты
- DMARC политики
- Верификация доменов (Google, Facebook и т.д.)
- Любая текстовая информация

**RFC:** RFC 1035

---

### SOA (Start of Authority) — Начало авторитетности

Определяет начало DNS зоны и содержит метаданные о зоне.

**Пример:**
```
example.com.    IN    SOA    ns1.example.com. admin.example.com. (
    2024011601  ; Serial number
    3600        ; Refresh (1 hour)
    1800        ; Retry (30 minutes)
    604800      ; Expire (1 week)
    86400       ; Minimum TTL (1 day)
)
```

**Параметры:**
- **MNAME** — первичный DNS сервер зоны
- **RNAME** — email администратора (символ @ заменяется на точку)
- **Serial** — номер версии зоны (увеличивается при изменениях)
- **Refresh** — как часто вторичные серверы должны проверять обновления
- **Retry** — интервал повтора при ошибке
- **Expire** — время, после которого зона считается устаревшей
- **Minimum TTL** — минимальный TTL для записей в зоне

**Использование:**
- Обязательная запись для каждой DNS зоны
- Определяет параметры синхронизации между серверами

**RFC:** RFC 1035

---

### SRV (Service) — Сервисная запись

Указывает расположение сервисов (например, XMPP, SIP).

**Пример:**
```
_xmpp._tcp.example.com.    IN    SRV    10 5 5223 xmpp.example.com.
```

**Формат:**
```
_сервис._протокол.домен.    IN    SRV    приоритет вес порт целевой_хост
```

**Параметры:**
- **Приоритет** — приоритет сервера (меньше = выше)
- **Вес** — для балансировки нагрузки между серверами с одинаковым приоритетом
- **Порт** — номер порта сервиса
- **Целевой хост** — доменное имя сервера

**RFC:** RFC 2782

---

### CAA (Certificate Authority Authorization) — Авторизация центра сертификации

Указывает, какие центры сертификации могут выдавать SSL/TLS сертификаты для домена.

**Пример:**
```
example.com.    IN    CAA    0 issue "letsencrypt.org"
example.com.    IN    CAA    0 issuewild "letsencrypt.org"
```

**Использование:**
- Безопасность: предотвращает несанкционированную выдачу сертификатов
- Контроль над SSL/TLS сертификатами домена

**RFC:** RFC 8659

---

## Специальные типы записей

### ANY — Любой тип

Запрос всех типов записей для домена. **Устарел** и не рекомендуется к использованию из-за проблем с безопасностью и производительностью.

**RFC:** RFC 1035 (устарел, см. RFC 8482)

---

## Таблица типов записей

| Тип | Номер | Назначение | RFC |
|-----|-------|------------|-----|
| A | 1 | IPv4 адрес | RFC 1035 |
| NS | 2 | DNS сервер | RFC 1035 |
| CNAME | 5 | Псевдоним | RFC 1035 |
| SOA | 6 | Начало зоны | RFC 1035 |
| PTR | 12 | Обратная запись | RFC 1035 |
| MX | 15 | Почтовый сервер | RFC 1035 |
| TXT | 16 | Текстовая запись | RFC 1035 |
| AAAA | 28 | IPv6 адрес | RFC 3596 |
| SRV | 33 | Сервисная запись | RFC 2782 |
| CAA | 257 | Авторизация CA | RFC 8659 |

## Примеры конфигураций

### Простой веб-сайт
```
example.com.        IN    A        93.184.216.34
www.example.com.    IN    CNAME    example.com.
```

### Веб-сайт с почтой
```
example.com.        IN    A        93.184.216.34
www.example.com.    IN    CNAME    example.com.
example.com.        IN    MX    10    mail.example.com.
mail.example.com.   IN    A        192.0.2.1
example.com.        IN    TXT    "v=spf1 mx ~all"
```

### Поддомен с отдельным сервером
```
example.com.        IN    NS    ns1.example.com.
api.example.com.    IN    NS    ns1.api.example.com.
api.example.com.    IN    A        192.0.2.10
```

## Ссылки на RFC

- **RFC 1035** — Domain Names — Implementation and Specification — основные типы записей
- **RFC 2782** — A DNS RR for specifying the location of services (SRV)
- **RFC 3596** — DNS Extensions to Support IP Version 6 (AAAA)
- **RFC 8659** — DNS-Based Authentication of Named Entities (CAA)
- **RFC 8482** — Providing Minimal-Sized Responses to DNS Queries That Have QTYPE=ANY

## Следующие шаги

Теперь, когда вы знаете типы записей, изучите:
- [Процесс резолвинга DNS](04-resolution-process.md) — как используются эти записи
- [Типы DNS серверов](05-server-types.md) — какие серверы хранят эти записи
